{"ast":null,"code":"var _jsxFileName = \"C:\\\\foodgram-project-react\\\\frontend\\\\src\\\\pages\\\\user\\\\index.js\",\n  _s = $RefreshSig$();\nimport { Card, Title, Pagination, CardList, Button, CheckboxGroup, Container, Main } from '../../components';\nimport cn from 'classnames';\nimport styles from './styles.module.css';\nimport { useRecipes } from '../../utils/index.js';\nimport { useEffect, useState, useContext } from 'react';\nimport api from '../../api';\nimport { useParams, useHistory } from 'react-router-dom';\nimport { UserContext } from '../../contexts';\nimport MetaTags from 'react-meta-tags';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { createElement as _createElement } from \"react\";\nconst UserPage = ({\n  updateOrders\n}) => {\n  _s();\n  const {\n    recipes,\n    setRecipes,\n    recipesCount,\n    setRecipesCount,\n    recipesPage,\n    setRecipesPage,\n    tagsValue,\n    setTagsValue,\n    handleTagsChange,\n    handleLike,\n    handleAddToCart\n  } = useRecipes();\n  const {\n    id\n  } = useParams();\n  const [user, setUser] = useState(null);\n  const [subscribed, setSubscribed] = useState(false);\n  const history = useHistory();\n  const userContext = useContext(UserContext);\n  const getRecipes = ({\n    page = 1,\n    tags\n  }) => {\n    api.getRecipes({\n      page,\n      author: id,\n      tags\n    }).then(res => {\n      const {\n        results,\n        count\n      } = res;\n      setRecipes(results);\n      setRecipesCount(count);\n    });\n  };\n  const getUser = () => {\n    api.getUser({\n      id\n    }).then(res => {\n      setUser(res);\n      setSubscribed(res.is_subscribed);\n    }).catch(err => {\n      history.push('/recipes');\n    });\n  };\n  useEffect(_ => {\n    if (!user) {\n      return;\n    }\n    getRecipes({\n      page: recipesPage,\n      tags: tagsValue,\n      author: user.id\n    });\n  }, [recipesPage, tagsValue, user]);\n  useEffect(_ => {\n    getUser();\n  }, []);\n  useEffect(_ => {\n    api.getTags().then(tags => {\n      setTagsValue(tags.map(tag => ({\n        ...tag,\n        value: true\n      })));\n    });\n  }, []);\n  return /*#__PURE__*/_jsxDEV(Main, {\n    children: /*#__PURE__*/_jsxDEV(Container, {\n      className: styles.container,\n      children: [/*#__PURE__*/_jsxDEV(MetaTags, {\n        children: [/*#__PURE__*/_jsxDEV(\"title\", {\n          children: user ? `${user.first_name} ${user.last_name}` : 'Страница пользователя'\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 81,\n          columnNumber: 9\n        }, this), /*#__PURE__*/_jsxDEV(\"meta\", {\n          name: \"description\",\n          content: user ? `Продуктовый помощник - ${user.first_name} ${user.last_name}` : 'Продуктовый помощник - Страница пользователя'\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 82,\n          columnNumber: 9\n        }, this), /*#__PURE__*/_jsxDEV(\"meta\", {\n          property: \"og:title\",\n          content: user ? `${user.first_name} ${user.last_name}` : 'Страница пользователя'\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 83,\n          columnNumber: 9\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 80,\n        columnNumber: 7\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: styles.title,\n        children: [/*#__PURE__*/_jsxDEV(Title, {\n          className: cn({\n            [styles.titleText]: (userContext || {}).id !== (user || {}).id\n          }),\n          title: user ? `${user.first_name} ${user.last_name}` : ''\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 86,\n          columnNumber: 9\n        }, this), /*#__PURE__*/_jsxDEV(CheckboxGroup, {\n          values: tagsValue,\n          handleChange: value => {\n            setRecipesPage(1);\n            handleTagsChange(value);\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 92,\n          columnNumber: 9\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 85,\n        columnNumber: 7\n      }, this), (userContext || {}).id !== (user || {}).id && /*#__PURE__*/_jsxDEV(Button, {\n        className: styles.buttonSubscribe,\n        clickHandler: _ => {\n          const method = subscribed ? api.deleteSubscriptions.bind(api) : api.subscribe.bind(api);\n          method({\n            author_id: id\n          }).then(_ => {\n            setSubscribed(!subscribed);\n          });\n        },\n        children: subscribed ? 'Отписаться от автора' : 'Подписаться на автора'\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 100,\n        columnNumber: 54\n      }, this), /*#__PURE__*/_jsxDEV(CardList, {\n        children: recipes.map(card => /*#__PURE__*/_createElement(Card, {\n          ...card,\n          key: card.id,\n          updateOrders: updateOrders,\n          handleLike: handleLike,\n          handleAddToCart: handleAddToCart,\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 115,\n            columnNumber: 30\n          }\n        }))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 114,\n        columnNumber: 7\n      }, this), /*#__PURE__*/_jsxDEV(Pagination, {\n        count: recipesCount,\n        limit: 6,\n        page: recipesPage,\n        onPageChange: page => setRecipesPage(page)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 123,\n        columnNumber: 7\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 79,\n      columnNumber: 5\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 78,\n    columnNumber: 10\n  }, this);\n};\n_s(UserPage, \"/210gA4QAxYbyNswPJq4MvVygAU=\", false, function () {\n  return [useRecipes, useParams, useHistory];\n});\n_c = UserPage;\nexport default UserPage;\nvar _c;\n$RefreshReg$(_c, \"UserPage\");","map":{"version":3,"names":["Card","Title","Pagination","CardList","Button","CheckboxGroup","Container","Main","cn","styles","useRecipes","useEffect","useState","useContext","api","useParams","useHistory","UserContext","MetaTags","jsxDEV","_jsxDEV","createElement","_createElement","UserPage","updateOrders","_s","recipes","setRecipes","recipesCount","setRecipesCount","recipesPage","setRecipesPage","tagsValue","setTagsValue","handleTagsChange","handleLike","handleAddToCart","id","user","setUser","subscribed","setSubscribed","history","userContext","getRecipes","page","tags","author","then","res","results","count","getUser","is_subscribed","catch","err","push","_","getTags","map","tag","value","children","className","container","first_name","last_name","fileName","_jsxFileName","lineNumber","columnNumber","name","content","property","title","titleText","values","handleChange","buttonSubscribe","clickHandler","method","deleteSubscriptions","bind","subscribe","author_id","card","key","__self","__source","limit","onPageChange","_c","$RefreshReg$"],"sources":["C:/foodgram-project-react/frontend/src/pages/user/index.js"],"sourcesContent":["import {\r\n  Card,\r\n  Title,\r\n  Pagination,\r\n  CardList,\r\n  Button,\r\n  CheckboxGroup,\r\n  Container,\r\n  Main \r\n} from '../../components'\r\nimport cn from 'classnames'\r\nimport styles from './styles.module.css'\r\nimport { useRecipes } from '../../utils/index.js'\r\nimport { useEffect, useState, useContext } from 'react'\r\nimport api from '../../api'\r\nimport { useParams, useHistory } from 'react-router-dom'\r\nimport { UserContext } from '../../contexts'\r\nimport MetaTags from 'react-meta-tags'\r\n\r\nconst UserPage = ({ updateOrders }) => {\r\n  const {\r\n    recipes,\r\n    setRecipes,\r\n    recipesCount,\r\n    setRecipesCount,\r\n    recipesPage,\r\n    setRecipesPage,\r\n    tagsValue,\r\n    setTagsValue,\r\n    handleTagsChange,\r\n    handleLike,\r\n    handleAddToCart\r\n  } = useRecipes()\r\n  const { id } = useParams()\r\n  const [ user, setUser ] = useState(null)\r\n  const [ subscribed, setSubscribed ] = useState(false)\r\n  const history = useHistory()\r\n  const userContext = useContext(UserContext)\r\n\r\n  const getRecipes = ({ page = 1, tags }) => {\r\n    api\r\n      .getRecipes({ page, author: id, tags })\r\n        .then(res => {\r\n          const { results, count } = res\r\n          setRecipes(results)\r\n          setRecipesCount(count)\r\n        })\r\n  }\r\n\r\n  const getUser = () => {\r\n    api.getUser({ id })\r\n      .then(res => {\r\n        setUser(res)\r\n        setSubscribed(res.is_subscribed)\r\n      })\r\n      .catch(err => {\r\n        history.push('/recipes')\r\n      })\r\n  }\r\n\r\n  useEffect(_ => {\r\n    if (!user) { return }\r\n    getRecipes({ page: recipesPage, tags: tagsValue, author: user.id })\r\n  }, [ recipesPage, tagsValue, user ])\r\n\r\n  useEffect(_ => {\r\n    getUser()\r\n  }, [])\r\n\r\n  useEffect(_ => {\r\n    api.getTags()\r\n      .then(tags => {\r\n        setTagsValue(tags.map(tag => ({ ...tag, value: true })))\r\n      })\r\n  }, [])\r\n\r\n\r\n  return <Main>\r\n    <Container className={styles.container}>\r\n      <MetaTags>\r\n        <title>{user ? `${user.first_name} ${user.last_name}` : 'Страница пользователя'}</title>\r\n        <meta name=\"description\" content={user ? `Продуктовый помощник - ${user.first_name} ${user.last_name}` : 'Продуктовый помощник - Страница пользователя'} />\r\n        <meta property=\"og:title\" content={user ? `${user.first_name} ${user.last_name}` : 'Страница пользователя'} />\r\n      </MetaTags>\r\n      <div className={styles.title}>\r\n        <Title\r\n          className={cn({\r\n            [styles.titleText]: (userContext || {}).id !== (user || {}).id\r\n          })}\r\n          title={user ? `${user.first_name} ${user.last_name}` : ''}\r\n        />\r\n        <CheckboxGroup\r\n          values={tagsValue}\r\n          handleChange={value => {\r\n            setRecipesPage(1)\r\n            handleTagsChange(value)\r\n          }}\r\n        />\r\n      </div>\r\n      {(userContext || {}).id !== (user || {}).id && <Button\r\n        className={styles.buttonSubscribe}\r\n        clickHandler={_ => {\r\n          const method = subscribed ? api.deleteSubscriptions.bind(api) : api.subscribe.bind(api) \r\n            method({\r\n              author_id: id\r\n            })\r\n            .then(_ => {\r\n              setSubscribed(!subscribed)\r\n            })\r\n        }}\r\n      >\r\n        {subscribed ? 'Отписаться от автора' : 'Подписаться на автора'}\r\n      </Button>}\r\n      <CardList>\r\n        {recipes.map(card => <Card\r\n          {...card}\r\n          key={card.id}\r\n          updateOrders={updateOrders}\r\n          handleLike={handleLike}\r\n          handleAddToCart={handleAddToCart}\r\n        />)}\r\n      </CardList>\r\n      <Pagination\r\n        count={recipesCount}\r\n        limit={6}\r\n        page={recipesPage}\r\n        onPageChange={page => setRecipesPage(page)}\r\n      />\r\n    </Container>\r\n  </Main>\r\n}\r\n\r\nexport default UserPage\r\n\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}